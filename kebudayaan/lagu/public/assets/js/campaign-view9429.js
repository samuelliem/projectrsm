$(document).ready(function(){$(".progress-bar").each(function(){each_bar_width=$(this).attr("aria-valuenow"),$(this).width(each_bar_width+"%")})}),window.Fanvestory=window.Fanvestory||{},function(a,e){var t=function(a,e){if(e&&e.empty&&"strict"==e.empty.mode&&!a)throw e.empty.error;if(!a)return 0;var t=parseFloat(a);if(isNaN(t)&&e&&e.numeric)throw e.numeric.error;if(e&&e.min&&t<e.min.min)throw e.min.error;if(e&&e.max&&t>e.max.max)throw e.max.error;return t},n=function(a,e){var t=Math.pow(10,e);return Math.round(a*t)/t},o=function(a,e){var t=null;if(t=1==a.length?a.val():a.filter(":checked").val(),!t&&e&&e.method)throw e.method.error;return t},i=function(a,e,t){var n=0;if(!a)return 0;if(t[e]&&window[e+"FeeCalculator"]){var o=new window[e+"FeeCalculator"](t[e]);n=o.getFee(a)}return n?n:0};window.Fanvestory.CampaignPercentCalculator=function(a){this.elements=a},window.Fanvestory.CampaignPercentCalculator.prototype.init=function(){this.elements.each(function(e){var r=a(this),c=r.data("campaign-percent-calculator-hide-on-error"),s=a(r.data("campaign-percent-calculator-input")),l=a(r.data("campaign-percent-calculator-fee-element")),d=a(r.data("campaign-percent-calculator-total-element")),u=a(r.data("campaign-percent-calculator-inputs-method")),h=a(r.data("campaign-percent-calculator-error")),m=r.data("campaign-percent-calculator-currency"),f=a(r.data("campaign-percent-calculator-button")),p=parseFloat(r.data("campaign-percent-calculator-total-min")),v=parseFloat(r.data("campaign-percent-calculator-total-max")),w=r.data("campaign-percent-calculator-gateways"),y=r.data("campaign-percent-calculator-on-button-click"),g=r.data("campaign-percent-calculator-on-error"),k=r.data("campaign-percent-calculator-on-amount-success"),C=r.data("campaign-percent-calculator-on-button-click-params"),b=r.data("campaign-percent-calculator-checks");s.add(u).on("change keyup ifChecked",function(a){var e=0,y=0;try{if(e=t(s.val(),b.amount),k){var C=new Function(k+"()");C()}if(u.length){var x=o(u,b.method);x&&(y=i(e,x,w))}h.addClass("hidden"),r.parent().removeClass("hidden"),f.attr("disabled",!e),f.data("amount",e)}catch(_){if(y=null,h.text(_.toString()).removeClass("hidden"),c&&r.parent().addClass("hidden"),f.attr("disabled",!0),g){var C=new Function(g+"()");C()}}var F=p<=0?0:n(100*e/p,3),T=v<=0?0:n(100*e/v,3),j=F==T?F+"%":T+"% - "+F+"%";c||"0%"!=j||(j=Translator.trans("misc.na.js")),r.html("<strong> "+j+"</strong>");var B=null!==y?n(y,2)+m:"N/A",P=null!==y?n(e+y,2)+m:"N/A";l.html("<strong>"+B+"</strong>"),d.html("<strong>"+P+"</strong>")}).change(),f.click(function(e){e.preventDefault();try{var n=t(s.val(),b.amount);if(!n&&b.amount.empty)throw b.amount.empty.error;if(h.addClass("hidden"),r.parent().removeClass("hidden"),y){var o=new Function("params",y+"(params)"),i={amount:n};C&&(i=a.extend(i,C)),o(i)}}catch(c){h.text(c.toString()).removeClass("hidden"),r.parent().addClass("hidden")}})})},a(e).ready(function(){var e=new window.Fanvestory.CampaignPercentCalculator(a("[data-campaign-percent-calculator]"));e.init()})}(jQuery,document),function(a,e){window.maksekeskusFeeCalculator=function(a){this.feePercent=parseFloat(a.feePercent),this.feeAmount=parseFloat(a.feeAmount),this.feeExtraAmount=parseFloat(a.feeExtraAmount),this.feeTaxPercent=parseFloat(a.feeTaxPercent)},window.maksekeskusFeeCalculator.prototype.getFee=function(a,e){var n=this.feeExtraAmount;if("only_service"===e)return n;"only_transfer"===e&&(n=0);var o=n+n*(this.feeTaxPercent/100),i=(a+o+this.feeAmount*(1+this.feeTaxPercent/100))/(1-this.feePercent/100*(1+this.feeTaxPercent/100)),r=i-a;return t(r,2)};var t=function(a,e){var t=Math.pow(10,e);return Math.round(a*t)/t}}(jQuery,document),function(a,e){window.everypayFeeCalculator=function(a){this.feePercent=parseFloat(a.feePercent),this.feeExtraAmount=parseFloat(a.feeExtraAmount),this.feeTaxPercent=parseFloat(a.feeTaxPercent)},window.everypayFeeCalculator.prototype.getFee=function(a,e){var n=this.feeExtraAmount;if("only_service"===e)return n;"only_transfer"===e&&(n=0);var o=n+n*(this.feeTaxPercent/100),i=(a+o)/(1-this.feePercent/100*(1+this.feeTaxPercent/100)),r=i-a;return t(r,2)};var t=function(a,e){var t=Math.pow(10,e);return Math.round(a*t)/t}}(jQuery,document),function(a,e){window.paypalFeeCalculator=function(a){this.feePercent=parseFloat(a.feePercent),this.feeAmount=parseFloat(a.feeAmount),this.feeExtraAmount=parseFloat(a.feeExtraAmount),this.feeTaxPercent=parseFloat(a.feeTaxPercent)},window.paypalFeeCalculator.prototype.getFee=function(a,e){var n=this.feeExtraAmount;if("only_service"===e)return n;"only_transfer"===e&&(n=0);var o=n+n*(this.feeTaxPercent/100),i=(a+o+this.feeAmount*(1+this.feeTaxPercent/100))/(1-this.feePercent/100*(1+this.feeTaxPercent/100)),r=i-a;return t(r,2)};var t=function(a,e){var t=Math.pow(10,e);return Math.round(a*t)/t}}(jQuery,document),function(a,e){a.paytrailFeeCalculator=function(a){this.feeExtraAmount=parseFloat(a.feeExtraAmount)},a.paytrailFeeCalculator.prototype.getFee=function(a,e){return"only_transfer"===e?0:t(this.feeExtraAmount,2)};var t=function(a,t){var n=e.pow(10,t);return e.round(a*n)/n}}(window,Math),window.Fanvestory=window.Fanvestory||{},function(a,e,t,n){var o=function(){window.Fanvestory.investView.close(),ErrorRenderer.displayTehnical()},i=function(a,t){var n={},i=e("#formDonation",a).serializeArray();for(var r in i){var c=i[r];"country"!=c.name&&(n[c.name]=c.value)}n.country=e('[data-group="'+n.group+'"] [name="country"]').val(),Object.keys(t).length&&(n=e.extend(n,t)),e(".wrap-loader").show(),e.ajax({data:n,dataType:"json",method:"POST",url:e("#formDonation").attr("action")}).success(function(a){if("success"==a.status)if(a.url)window.location=a.url;else if(a.form){var t=e(a.form),n=t.filter("form");e("body").append(n),n.submit()}else window.location.reload(!1);else o();e(".wrap-loader").hide()}).error(function(){e(".wrap-loader").hide(),o()})},r=function(a,t){e("#formDonation",a).submit(function(a){a.preventDefault()}),e("#onlyNumber-modal",a).val(t.amount),e("#onlyNumber-modal",a).focus(),e("#onlyNumber-modal",a).keydown(function(a){e.inArray(a.keyCode,[46,8,9,27,13])!==-1||65===a.keyCode&&(a.ctrlKey===!0||a.metaKey===!0)||a.keyCode>=35&&a.keyCode<=40||(a.shiftKey||a.keyCode<48||a.keyCode>57)&&(a.keyCode<96||a.keyCode>105)&&a.preventDefault()}),e('input:not([name="group"])',a).iCheck({checkboxClass:"icheckbox_flat-grey",radioClass:"iradio_square-red",increaseArea:"20%"}),e("[data-group-check]",a).click(function(a){var t=e(this).next();t.prop("checked",!0),t.change()}),e('[name="group"]',a).on("change ifChecked",function(t){e("[data-group-check]").removeClass("active"),e("[data-group-check] .checked-badge").addClass("hidden"),e(this).prev().addClass("active"),e(this).prev().find(".checked-badge").removeClass("hidden"),e("[data-method-container]",a).hide(),e("[data-choices-container]",a).hide(),"credit"!=e(this).val()?e("[data-country-container]",a).show():e("[data-country-container]",a).hide(),e('[name="country"]',a).iCheck("uncheck"),e("[data-group]",a).hide();var n=e('[data-group="'+e(this).val()+'"]',a),o=n.data("default");o&&e('select:first option[value="'+o+'"]',n).length||(o=e("select:first option:first",n).val()),e("select:first",n).val(o).trigger("change"),"credit"!=e(this).val()&&n.show(),e("[data-choice-title]").addClass("hidden"),e('[data-choice-title="'+e(this).val()+'"]').removeClass("hidden")});var r=function(a){if(!a.id)return a.text;var t="/public/img/country",n=e('<span><img src="'+t+"/"+a.id+'.svg" class="img-flag" /> '+a.text+"</span>");return n};e('[name="country"]').select2({templateResult:r,templateSelection:r,minimumResultsForSearch:-1}),e('[name="country"]',a).on("change ifChecked",function(t){e("[data-country]",a).hide(),e("[data-choices-container]",a).hide(),e('[name="method"]',a).iCheck("uncheck");var n=e('[data-country="'+e('[name="group"]:checked').val()+"_"+e(this).val()+'"]',a);1==n.find('[name="method"]').length?(n.find('[name="method"]:first').iCheck("check"),e("[data-method-container]",a).hide()):(e("[data-method-container]",a).show(),n.show())}),e('[name="method"]',a).on("change ifChecked",function(t){e("[data-choices-container]",a).hide();var n=e('[name="amount"]',a).val(),r=e('[name="group"]:checked',a).val(),c=e('[name="country"]',a).val(),s=e('[name="method"]:checked',a).val();if(n&&r&&c&&s){var l={},d=e("#formDonation",a).serializeArray();for(var u in d){var h=d[u];"country"!=h.name&&(l[h.name]=h.value)}l.country=e('[data-group="'+l.group+'"] [name="country"]').val(),l.only_pre=!0;var m=function(t){if(t||(t={}),t.choices||(t.choices={},t.choices[s]=s,t.name="_payment_placeholder"),t.choices){e("[data-choices]",a).empty();for(var n in t.choices){var o=e("[data-choices]",a).data("versioning"),r=e("[data-choices]",a).data("choices")+"/"+n+".png"+(o?"?v="+o:"");e("[data-choices]",a).append('<li><a href="javascript:void(0);" data-payment-choice="'+n+'"><img src="'+r+'" alt="'+n+'" onerror="$(this).parents(\'li:first\').remove()" /></a></li>')}e("[data-payment-choice]",a).click(function(n){n.preventDefault();var o={};o[t.name]=e(this).data("payment-choice"),i(a,o)}),e("[data-choices-container]",a).show()}},f=e("[data-choices-container]",a).data("choices-container");f&&f[r]&&f[r][c]&&void 0!==f[r][c][s]?m(f[r][c][s]):(e(".wrap-loader").show(),e.ajax({data:l,dataType:"json",method:"POST",url:e("#formDonation").attr("action")}).success(function(a){"success"==a.status?m(a):o(),e(".wrap-loader").hide()}).error(function(){e(".wrap-loader").hide(),o()}))}});var c=new n(e("[data-campaign-percent-calculator]",a));c.init()};window.Fanvestory.investView={modal:null,manuallyHidden:null,run:function(a){var t=this;e(".wrap-loader").show(),e.ajax({url:a.url}).done(function(n){var o=e(n);o.attr("data-purchase-modal",""),e("[data-purchase-modal]").remove(),e("body").append(o),r(o,a),o.modal(),o.on("hide.bs.modal",function(){window.history&&window.history.replaceState("invest.view","invest.view",window.location.pathname)}),t.modal=o,window.history&&window.history.replaceState("invest.view","invest.view",window.location.pathname+"?amount="+a.amount),e(".wrap-loader").hide()}).error(function(){e(".wrap-loader").hide(),o()})},hideMethodSelection:function(){if(this.modal){var a=e("[data-group-container]:visible, [data-country-container]:visible, [data-method-container]:visible, [data-choices-container]:visible",this.modal);a.hide(),this.manuallyHidden?this.manuallyHidden.add(a):this.manuallyHidden=a}},restoreMethodSelection:function(){this.manuallyHidden&&(this.manuallyHidden.show(),this.manuallyHidden=null)},close:function(){this.modal&&this.modal.modal("hide")}}}(document,jQuery,swal,window.Fanvestory.CampaignPercentCalculator),function(a){a.CampaignPercentCalculator=function(){},a.CampaignPercentCalculator.prototype.getPercent=function(a,e){return e<=0?0:100*a/e},a.CampaignPercentCalculator.prototype.getAmount=function(a,e){return e<=0?0:e*a/100}}(window),function(a,e,t){var n="[data-campaign-purchase-slider]",o=e(n);if(o.length){var i=o.data("campaign-purchase-slider"),r=e(i.amountInput),c=e(i.button),s=e(i.errorText),l=i.errors,d=new CampaignPercentCalculator,u=function(a,e){var t=Math.pow(10,e);return Math.round(a*t)/t},h=function(a){var t=u(d.getPercent(a,i.maxTotal),3).toFixed(3),n=u(d.getPercent(a,i.minTotal),3).toFixed(3),o=n;t!=n&&(o=t+" - "+n),e(i.percentLabel).text(o)},m=function(a){return parseInt(a)},f=function(a){return a||"0"===a||0===a?(a=m(a),isNaN(a)?l.numeric:a<i.min?l.min:a>i.max?l.max:null):l.empty},p=function(a){s.text(a),r.addClass("error"),c.attr("disabled",!0)},v=function(){s.text(""),r.removeClass("error"),c.attr("disabled",!1)};o.slider({range:"min",animate:!0,value:i.value,min:i.min,max:i.max,step:1,slide:function(a,e){var t=f(e.value),n=m(e.value);return t?void p(t):(v(),r.val(n),void h(n))}}),r.on("keyup change",function(a){var t=e(this).val(),n=f(t),i=m(t);return n?void p(n):(v(),o.slider("value",i),void h(i))}).trigger("change"),c.click(function(a){a.preventDefault(),t.run({url:c.data("purchase-slider-button"),amount:r.val()})})}}(document,jQuery,window.Fanvestory.investView),function(){window.OnlyNumber={attach:function(a){$(a).keydown(function(a){$.inArray(a.keyCode,[46,8,9,27,13])!==-1||65===a.keyCode&&(a.ctrlKey===!0||a.metaKey===!0)||a.keyCode>=35&&a.keyCode<=40||(a.shiftKey||a.keyCode<48||a.keyCode>57)&&(a.keyCode<96||a.keyCode>105)&&a.preventDefault()})}},window.OnlyNumber.attach("[data-only-number]")}(),function(a){window.MaxLength={attach:function(e,t){$(e).keydown(function(e){if(!($.inArray(e.keyCode,[46,8,9,27,13])!==-1||65===e.keyCode&&(e.ctrlKey===!0||e.metaKey===!0)||e.keyCode>=35&&e.keyCode<=40)&&(t===a&&(t=parseInt($(this).data("max-length"))),t||0===t)){var n=$(this).val().toString(),o=n+String.fromCharCode(e.keyCode);o.length>t&&e.preventDefault()}})}},window.MaxLength.attach("[data-max-length]")}(),window.Fanvestory=window.Fanvestory||{},window.Fanvestory.Gamification=window.Fanvestory.Gamification||{},function(a,e,t){window.Fanvestory.Gamification.ActionHandler={redirect:function(a){var e=a.url;window.location.replace(e)},purchase:function(e){swal({title:e.title,html:e.html,customClass:"task-modal",showCancelButton:!1,showConfirmButton:!1});var t=a(swal.getContent()).find("a");t.length&&t.click(function(a){a.preventDefault(),swal.close(),window.Fanvestory&&window.Fanvestory.investView&&window.Fanvestory.investView.run({url:e.modalUrl,amount:parseInt(e.goal)})})},facebook_share:function(e){swal({title:Translator.trans("gamification.share_on_facebook.js"),html:e.html,customClass:"task-modal",showCancelButton:!1,showConfirmButton:!1}),a(swal.getContent()).find("a").click(function(a){FB.ui({method:"share",display:"popup",href:e.url},function(a){swal.close(),a&&!a.error_code&&"undefined"!=typeof a&&(ga("send","event","social","Facebook","share-complete"),window.Fanvestory.Gamification.TaskConfirmer.confirm(e.confirmUrl,{shared:!0}))})})},facebook_like:function(a){swal({title:Translator.trans("gamification.like_facebook_page.js"),html:a.html,customClass:"task-modal",showCancelButton:!1,showConfirmButton:!1}).then(function(e){window.Fanvestory.Gamification.TaskConfirmer.confirm(a.confirmUrl,{liked:!0})})["catch"](function(e){window.Fanvestory.Gamification.TaskConfirmer.confirm(a.confirmUrl,{liked:!0})});var e=swal.getContent();FB.XFBML.parse(e)},facebook_post:function(a){swal({title:Translator.trans("gamification.attend_on_facebook.js"),html:a.html,customClass:"task-modal",showCancelButton:!1,showConfirmButton:!1}).then(function(e){window.Fanvestory.Gamification.TaskConfirmer.confirm(a.confirmUrl,{done:!0})})["catch"](function(e){window.Fanvestory.Gamification.TaskConfirmer.confirm(a.confirmUrl,{done:!0})})},facebook_send:function(e){swal({title:Translator.trans("gamification.send_on_facebook.js"),html:e.html,customClass:"task-modal",showCancelButton:!1,showConfirmButton:!1}),a(swal.getContent()).find("a").click(function(a){FB.ui({method:"send",link:e.url},function(a){swal.close(),a&&"object"==typeof a&&a.success&&window.Fanvestory.Gamification.TaskConfirmer.confirm(e.confirmUrl,{sent:!0})})})},invite_friend:function(a){swal({title:Translator.trans("gamification.invite_friend.js"),html:a.html,customClass:"task-modal",showCancelButton:!1,showConfirmButton:!1})},friend_purchase:function(a){swal({title:Translator.trans("gamification.friend_purchase.js"),html:a.html,customClass:"task-modal",showCancelButton:!1,showConfirmButton:!1})},no_friends:function(a){swal({title:Translator.trans("gamification.invite_friend.js"),html:a.html,customClass:"task-modal",showCancelButton:!1,showConfirmButton:!1})},friend_score_pass:function(a){swal({title:"Pass a friend in the scoreboard",html:a.html,customClass:"task-modal",showCancelButton:!1,showConfirmButton:!1})},badge_percent:function(a){swal({title:Translator.trans("gamification.earn_badge_percent.js"),html:a.html,customClass:"task-modal",showCancelButton:!1,showConfirmButton:!1})},duplicate_message:function(a){swal({title:Translator.trans("error.error.js"),text:Translator.trans("gamification.already_completed.js"),type:"error",confirmButtonText:Translator.trans("misc.close.js")})}},window.Fanvestory.Gamification.Notification={queued:[],run:function(){var e=this;a("[data-gamification-notification]").each(function(){var t=a(this).data("gamification-notification");t.queued?e.queueNotification(t):e.runNotification(t)})},queueNotification:function(a){this.queued.push(a)},runLastQueuedNotification:function(){var a=this.queued.pop();a&&this.runNotification(a)},runNotification:function(a){var e=function(a){a.levelHtml&&swal({title:a.levelTitle,html:a.levelHtml,customClass:"reward-modal",showCancelButton:!1,showConfirmButton:!1})};swal({title:a.title,html:a.html,customClass:"reward-modal",showCancelButton:!1,showConfirmButton:!1}).then(function(){e(a)})["catch"](function(){e(a)})}},window.Fanvestory.Gamification.TaskConfirmer={confirm:function(e,n,o){o=o===t||o,a.ajax({type:"POST",url:e,dataType:"json",headers:{"X-CSRF-TOKEN":a('meta[name="csrf-token"]').attr("content")},data:n,success:function(t){if("success"==t.status){var n=t.levelNotification,i=function(a){a&&swal({title:a.title,html:a.html,customClass:"reward-modal",showCancelButton:!1,showConfirmButton:!1})};swal({title:t.notification.title,html:t.notification.html,customClass:"reward-modal",showCancelButton:!1,showConfirmButton:!1}).then(function(){i(n)})["catch"](function(){i(n)}),t.levels&&a("[data-gamification-levels]").replaceWith(t.levels),t.points&&a("[data-gamification-points]").text(t.points),t.badgesHtml&&a("[data-gamification-badges]").replaceWith(t.badgesHtml),t.leaderboardHtml&&a("[data-gamification-leaderboard]").replaceWith(t.leaderboardHtml);var r=a('[data-task-container="'+t.task+'"]');r.length&&(r.find(".task-box").addClass("task-done"),r.find(".task-confirm").remove(),r.find(".task-success").show()),window.Fanvestory.Gamification.Badges.init(),window.Fanvestory.Gamification.Leaderboard.init()}else if("action"==t.status){if(!o)return;var c=window.Fanvestory.Gamification.ActionHandler;!c[t.action],t.params.confirmUrl=e,c[t.action](t.params)}else swal({title:Translator.trans("error.error.js"),text:t.message,type:"error",confirmButtonText:Translator.trans("misc.close.js")})},error:function(a){ErrorRenderer.displayTehnical()}})}},window.Fanvestory.Gamification.Badges={init:function(){this.addPopovers();var e=this;a("[data-gamification-badges-see-all]").click(function(t){t.preventDefault(),a(".wrap-loader").show();var n=a(this).data("gamification-badges-see-all");a.ajax({url:"/gamification/badges/"+n}).done(function(t){a(".wrap-loader").hide();var n=a(t);n.attr("data-gamification-badges-modal","1"),a("[data-gamification-badges-modal]").remove(),a("body").append(n),e.addPopovers(n),n.modal()}).error(function(){a(".wrap-loader").hide(),ErrorRenderer.displayTehnical()})})},addPopovers:function(e){a(".listbadges .media-object",e).popover({rel:"popover",trigger:"hover",placement:"bottom",container:"body",delay:100,template:'<div class="popover badge-popover" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'})}},window.Fanvestory.Gamification.Leaderboard={init:function(){a("[data-gamification-leaderboard-see-all]").click(function(e){e.preventDefault(),a(".wrap-loader").show();var t=a(this).data("gamification-leaderboard-see-all");a.ajax({url:"/gamification/leaderboard/"+t}).done(function(e){a(".wrap-loader").hide();var t=a(e);t.attr("data-gamification-leaderboard-modal","1"),a("[data-gamification-leaderboard-modal]").remove(),a("body").append(t),t.modal()}).error(function(){a(".wrap-loader").hide(),ErrorRenderer.displayTehnical()})})}},window.Fanvestory.Gamification.Tasks={init:function(){a("[data-task-confirm]").click(function(e){e.preventDefault(),window.Fanvestory.Gamification.TaskConfirmer.confirm(a(this).data("task-confirm"),{})})}},a(e).ready(function(){a("[data-gamification-start]").click(function(e){e.preventDefault(),a(".wrap-loader").show(),a.ajax({type:"POST",url:a(this).data("gamification-start"),dataType:"json",headers:{"X-CSRF-TOKEN":a('meta[name="csrf-token"]').attr("content")},data:{},success:function(e){a(".wrap-loader").hide(),a("[data-gamification-start]").hide(),a("[data-hidden-gamification]").removeClass("hidden").removeClass("blur"),a('[data-show-gamification="started"]').removeClass("hidden"),a('[data-show-gamification="not_started"]').addClass("hidden"),e.levelsHtml&&a("[data-gamification-levels]").replaceWith(e.levelsHtml),e.badgesHtml&&(a("[data-gamification-badges]").replaceWith(e.badgesHtml),window.Fanvestory.Gamification.Badges.init()),e.levelNotification&&swal({title:e.levelNotification.title,html:e.levelNotification.html,customClass:"reward-modal",showCancelButton:!1,showConfirmButton:!1})},error:function(e){a(".wrap-loader").hide(),ErrorRenderer.displayTehnical()}})}),window.Fanvestory.Gamification.Tasks.init(),window.Fanvestory.Gamification.Notification.run(),window.Fanvestory.Gamification.Badges.init(),window.Fanvestory.Gamification.Leaderboard.init()})}(jQuery,document),window.Fanvestory=window.Fanvestory||{},function(a,e,t,n){var o=function(){ErrorRenderer.displayTehnical()},i=function(a,e,t,n){var o=0,i=e+"FeeCalculator";if(t[e]&&window[i]){var r=new window[i](t[e]);o=r.getFee(a,n)}return o?o:0},r=function(a){if(!a.id)return a.text;var t=e(a.element).data("flag"),n=e('<span><img src="'+t+'" class="img-flag" /> '+a.text+"</span>");return n},c=function(a){e("[data-count-error-container]").removeClass("hidden"),e("[data-count-error]").html('<i class="glyphicon glyphicon-remove myicon-right"></i> '+a),e("[data-total-shares]").text("N/A")},s=function(){e("[data-count-error-container]").addClass("hidden")},l=function(a){var t=parseInt(e('[name="count"]').val());if(isNaN(t))c("Quantity must be a number");else if(t<a.min_count)c("Quantity must be at least "+a.min_count);else{if(!(t>a.max_count))return s(),t;c("Quantity must not be greater than "+a.max_count)}return!1},d=function(a){var t=l(a),n=e('[name="shipping_method"]:checked').val();if(a.shipping_required&&"post"==n){var o=e('[name="shipping_name"]').val(),i=e('[name="shipping_address"]').val(),r=e('[name="shipping_postcode"]').val(),c=e('[name="post_phone"]').val();if(!(o&&i&&r&&c))return e("[data-shipping-error]").removeClass("hidden"),!1}else if(a.shipping_required&&"omniva"==n){var s=e('[name="omniva_phone"]').val();if(!s)return e("[data-shipping-error]").removeClass("hidden"),!1}return t},u=function(a){var t=e('[name="method"]:checked').val(),n=l(a),o=e("[data-use-wallet]:checked").length?a.wallet_amount:0,r=n*a.total_price;if(r+1<=o)return e("[data-total-fee]").text("1€"),void e("[data-total-payment]").text("0€");if(!t||!n)return e("[data-total-fee]").text("N/A"),void e("[data-total-payment]").text("N/A");var o=e("[data-use-wallet]:checked").length?a.wallet_amount:0,r=n*a.total_price,c=r;o>0&&o>c?c=0:o>0&&(c-=o);var s=c<=0?"only_service":"full",d=i(c,t,a.gateways,s),u=c;if(c<=0)if(o<r+d){var h=r+d-o;d=i(h,t,a.gateways,"only_transfer"),u=h+d,d=u}else u=0;else u+=d;e("[data-total-fee]").text(d.toFixed(2)+"€"),e("[data-total-payment]").text(u.toFixed(2)+"€")},h=function(a){var e=l(a);if(!e)return!1;var t=a.wallet_amount,n=e*a.total_price;return n+=1,t>=n},m=function(a,t,n){var i={},r=e("#formDonation",a).serializeArray();for(var c in r){var s=r[c];"country"!=s.name&&(i[s.name]=s.value)}i.country=e('[data-group="'+i.group+'"] [name="country"]').val(),i.use_wallet=e("[data-use-wallet]:checked").length,Object.keys(n).length&&(i=e.extend(i,n)),e(".wrap-loader").show(),e.ajax({data:i,dataType:"json",method:"POST",url:t.url}).success(function(a){if("success"==a.status)if(a.url)window.location=a.url;else if(a.form){var t=e(a.form),n=t.filter("form");e("body").append(n),n.submit()}else window.location.reload(!1);else o();e(".wrap-loader").hide()}).error(function(){e(".wrap-loader").hide(),o()})},f=function(a,t){if(e("#formDonation",a).submit(function(a){a.preventDefault()}),t.shipping_required){new OmnivaWidget({compact_mode:!0,show_offices:!1,show_machines:!0,custom_html:!0,selection_value:"tallinna postkontor",country_id:"EE",show_logo:!1,show_explanation:!1});e("[data-shipping-method-check]",a).click(function(t){var n=e(this).next();n.prop("checked",!0),n.change(),e("[data-use-wallet]",a).trigger("change")}),e('[name="shipping_method"]',a).on("change ifChecked",function(a){e("[data-shipping-method-check]").removeClass("active"),e("[data-shipping-method-check] .checked-badge").addClass("hidden"),e(this).prev().addClass("active"),e(this).prev().find(".checked-badge").removeClass("hidden"),e("[data-shipping-method-inputs]").addClass("hidden"),e('[data-shipping-method-inputs="'+e(this).val()+'"]').removeClass("hidden"),e("[data-payment-methods-container]").removeClass("hidden")})}e("[data-shipping-error] button, [data-count-error-container] button").click(function(a){e(this).parent().parent().addClass("hidden")}),e("#onlyNumber-modal",a).focus(),e("#onlyNumber-modal",a).keydown(function(a){e.inArray(a.keyCode,[46,8,9,27,13])!==-1||65===a.keyCode&&(a.ctrlKey===!0||a.metaKey===!0)||a.keyCode>=35&&a.keyCode<=40||(a.shiftKey||a.keyCode<48||a.keyCode>57)&&(a.keyCode<96||a.keyCode>105)&&a.preventDefault()}),e('[name="count"]').on("change keyup",function(){var n=l(t);if(n){var o=n*t.share_percentage;e("[data-total-shares]").text(o.toFixed(4)+"%"),u(t),e("[data-use-wallet]",a).trigger("change")}}),e("[data-use-wallet]",a).iCheck({checkboxClass:"icheckbox_flat-pink",radioClass:"iradio_square-red",increaseArea:"20%"}).on("change ifChanged",function(n){u(t);var o=e("[data-use-wallet]:checked",a).length;if(o&&h(t))t.shipping_required&&!e('[name="shipping_method"]:checked').length||e("[data-wallet-pay-container]").show(),e("[data-payment-methods-container]").hide(),e("[data-country-container]").hide(),e("[data-choices-container]").hide();else{e("[data-wallet-pay-container]").hide(),e("[data-payment-methods-container]").show();var i=e('[name="group"]:checked');i.length&&("credit"!==i.val()&&"paypal"!==i.val()&&e("[data-country-container]").show(),e("[data-choices-container]").show())}}),e("[data-wallet-pay]",a).click(function(e){if(e.preventDefault(),d(t)){var n={};m(a,t,n)}}),e("[data-group-check]",a).click(function(a){var t=e(this).next();t.prop("checked",!0),t.change()}),e('[name="group"]',a).on("change ifChecked",function(t){e("[data-group-check]").removeClass("active"),e("[data-group-check] .checked-badge").addClass("hidden"),e(this).prev().addClass("active"),e(this).prev().find(".checked-badge").removeClass("hidden"),e("[data-method-container]",a).hide(),e("[data-choices-container]",a).hide(),"credit"!=e(this).val()&&"paypal"!=e(this).val()?e("[data-country-container]",a).show():e("[data-country-container]",a).hide(),e('[name="country"]',a).iCheck("uncheck"),e("[data-group]",a).hide();var n=e('[data-group="'+e(this).val()+'"]',a),o=n.data("default");o&&e('select:first option[value="'+o+'"]',n).length||(o=e("select:first option:first",n).val()),e("select:first",n).val(o).trigger("change"),"credit"!=e(this).val()&&"paypal"!=e(this).val()&&n.show(),e("[data-choice-title]").addClass("hidden"),e('[data-choice-title="'+e(this).val()+'"]').removeClass("hidden")}),e('[name="country"], [name="shipping_country"]').select2({templateResult:r,templateSelection:r,minimumResultsForSearch:-1}),e('[name="country"]',a).on("change ifChecked",function(t){e("[data-country]",a).hide(),e("[data-choices-container]",a).hide(),e('[name="method"]',a).iCheck("uncheck");var n=e('[data-country="'+e('[name="group"]:checked').val()+"_"+e(this).val()+'"]',a);1==n.find('[name="method"]').length?(n.find('[name="method"]:first').iCheck("check"),e("[data-method-container]",a).hide()):(e("[data-method-container]",a).show(),n.show())}),e('[name="method"]',a).on("change ifChecked",function(n){e("[data-choices-container]",a).hide();var o=e('[name="count"]',a).val(),i=e('[name="group"]:checked',a).val(),r=e('[name="country"]',a).val(),c=e('[name="method"]:checked',a).val();if(o&&i&&r&&c){var s={},l=e("#formDonation",a).serializeArray();for(var h in l){var f=l[h];"country"!=f.name&&(s[f.name]=f.value)}s.country=e('[data-group="'+s.group+'"] [name="country"]').val(),s.only_pre=!0;var p=function(n){if(n||(n={}),n.choices||(n.choices={},n.choices[c]=c,n.name="_payment_placeholder"),n.choices){e("[data-choices]",a).empty();for(var o in n.choices){var i=e("[data-choices]",a).data("versioning"),r=e("[data-choices]",a).data("choices")+"/"+o+".png"+(i?"?v="+i:"");e("[data-choices]",a).append('<li><a href="javascript:void(0);" data-payment-choice="'+o+'"><img src="'+r+'" alt="'+o+'" onerror="$(this).parents(\'li:first\').remove()" /></a></li>')}e("[data-payment-choice]",a).click(function(o){if(o.preventDefault(),d(t)){var i={};i[n.name]=e(this).data("payment-choice"),m(a,t,i)}}),e("[data-choices-container]",a).show()}},v=e("[data-choices-container]",a).data("choices-container");p(v[i][r][c]),u(t)}}),1===e("[data-shipping-method-check]").length&&e("[data-shipping-method-check]").trigger("click")};window.Fanvestory.MerchPurchaseView={run:function(a){e(".wrap-loader").show(),e.ajax({url:a.url}).done(function(t){var n=e(t);n.attr("data-merch-purchase-modal",""),e("[data-merch-purchase-modal]").remove(),e("body").append(n),f(n,e.extend(a,n.data("merch-purchase-data"))),n.modal(),e(".wrap-loader").hide()}).error(function(){e(".wrap-loader").hide(),o()})}},e(a).ready(function(){e("[data-merch-purchase]").click(function(a){a.preventDefault(),window.Fanvestory.MerchPurchaseView.run({url:e(this).data("merch-purchase")})})})}(document,jQuery,swal,window.Fanvestory.CampaignPercentCalculator);var fanvestoryMeta=JSON.parse($('meta[name="fanvestory-campaign"]').attr("content"));$(document).ready(function(){textTruncate(".campaign-tasks"," "+Translator.trans("misc.view_more.js")),$("[data-email-verification-modal]").click(function(a){a.preventDefault();var e="<p>"+Translator.trans("users.verify_before_purchase.js")+"</p><br />";e+="<p>"+Translator.trans("users.resend_verification_link.js")+"</p>",swal({title:Translator.trans("users.title_email_verify.js"),html:e,confirmButtonText:Translator.trans("misc.close.js"),type:"warning",onOpen:function(a){a=$(a),$("[data-swal-verify]",a).click(function(a){a.preventDefault(),$.ajax({type:"GET",url:fanvestoryMeta.verifySendUrl,dataType:"json",headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}}).done(function(a){"success"==a.status?swal({title:Translator.trans("misc.success.js"),text:a.message,type:"success",confirmButtonText:Translator.trans("misc.close.js")}):ErrorRenderer.displayTehnical()})})}})});var a=$("#audio-player");if(a.length){new zAudio({divId:"audio-player",autoplay:!1,miniplayer:!0},[{title:"",artist:"",albumArturl:"",url:a.attr("song-url")}])}var e=$("#invest-button-login");e.length&&($("#loginModal").on("hide.bs.modal",function(){window.history&&window.history.replaceState("invest.view","invest.view",window.location.pathname)}),e.click(function(a){var e=$('[name="amount"]').val();window.history&&e&&window.history.replaceState("invest.view","invest.view",window.location.pathname+"?amount="+e)})),fanvestoryMeta.amount&&$("#invest-button").click()});var fbShareBtn=document.getElementById("fb-shareBtn");fbShareBtn&&(document.getElementById("fb-shareBtn").onclick=function(){FB.ui({method:"share",display:"popup",href:fanvestoryMeta.facebookShareUrl},function(a){a&&!a.error_code&&"undefined"!=typeof a&&(ga("send","event","social","Facebook","share-complete"),$.ajax({url:fanvestoryMeta.socialEventUrl,dataType:"json",type:"POST",data:{type:"campaign_share",gateway:"facebook",data:{campaign:fanvestoryMeta.campaignId}},success:function(a){}}))})}),$("#embedCode").click(function(){var a=$(this);a.select()}),$(document).on("click","#listDonations .loadPaginator",function(a){a.preventDefault(),$(".wrap-loader").show(),$.ajax({url:fanvestoryMeta.supportersUrl}).done(function(a){$(".wrap-loader").hide();var e=$(a);e.attr("data-purchases-modal","1"),$("[data-purchases-modal]").remove(),
$("body").append(e),e.find(".timeAgo").timeago(),e.modal()}).error(function(){$(".wrap-loader").hide(),ErrorRenderer.displayTehnical()})}),$(document).keypress(function(a){13==a.which&&$("#onlyNumber").val()&&!$("#formDonation:visible").length&&$("#invest-button, #invest-button-login, [data-email-verification-modal]").click()}),fanvestoryMeta.isAuthenticated&&$("#successModal").modal("toggle"),fanvestoryMeta.wasSuccessfulPurchase?swal({title:Translator.trans("misc.congratulations.js"),html:$(fanvestoryMeta.successfulPurchaseHtml),type:"success",confirmButtonText:Translator.trans("misc.close.js")}).then(function(){window.Fanvestory.Gamification.Notification.runLastQueuedNotification()}):fanvestoryMeta.wasCancelledPurchase?swal({title:Translator.trans("error.error_occurred.js"),text:Translator.trans("misc.donation_cancel.js"),type:"error",confirmButtonText:Translator.trans("misc.close.js")}):fanvestoryMeta.wasErrorPurchase&&swal({title:Translator.trans("misc.donation_error_title.js"),text:Translator.trans("misc.donation_error.js"),type:"error",confirmButtonText:Translator.trans("misc.close.js")});